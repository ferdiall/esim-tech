{% extends "admin/base_site.html" %}
{% load static %}

{% block content %}

<h1 style="margin-bottom:20px; font-size:22px; color:#1f4e6e;">Yönetim Paneli</h1>

<!-- DASHBOARD INFO CARDS -->
<div style="
    display: flex;
    gap: 20px;
    margin-bottom: 30px;
    flex-wrap: wrap;
">

    <!-- Toplam ESIM -->
    <div style="
        flex: 1;
        min-width: 220px;
        background:white;
        padding:20px;
        border-radius:16px;
        border:1px solid #e5e7eb;
        box-shadow:0 4px 8px rgba(0,0,0,0.05);
    ">
        <h3 style="color:#1f4e6e;">Toplam eSIM</h3>
        <p style="font-size:32px; font-weight:bold; color:#1f4e6e;">
            {{ total_esim }}
        </p>
    </div>

    <!-- Aktif ESIM -->
    <div style="
        flex: 1;
        min-width: 220px;
        background:white;
        padding:20px;
        border-radius:16px;
        border:1px solid #e5e7eb;
        box-shadow:0 4px 8px rgba(0,0,0,0.05);
    ">
        <h3 style="color:#22c55e;">Aktif eSIM</h3>
        <p style="font-size:32px; font-weight:bold; color:#22c55e;">
            {{ active_count }}
        </p>
    </div>

    <!-- Pasif ESIM -->
    <div style="
        flex: 1;
        min-width: 220px;
        background:white;
        padding:20px;
        border-radius:16px;
        border:1px solid #e5e7eb;
        box-shadow:0 4px 8px rgba(0,0,0,0.05);
    ">
        <h3 style="color:#3b82f6;">Pasif eSIM</h3>
        <p style="font-size:32px; font-weight:bold; color:#3b82f6;">
            {{ passive_count }}
        </p>
    </div>

    <!-- Kullanıcı -->
    <div style="
        flex: 1;
        min-width: 220px;
        background:white;
        padding:20px;
        border-radius:16px;
        border:1px solid #e5e7eb;
        box-shadow:0 4px 8px rgba(0,0,0,0.05);
    ">
        <h3 style="color:#1f4e6e;">Toplam Kullanıcı</h3>
        <p style="font-size:32px; font-weight:bold; color:#1f4e6e;">
            {{ total_users }}
        </p>
    </div>

</div>

<!-- PIE CHART -->
<div style="
    background:white;
    padding:20px;
    border-radius:16px;
    border:1px solid #e5e7eb;
    box-shadow:0 4px 8px rgba(0,0,0,0.05);
    margin-bottom:30px;
    width:400px;
">
<div style="
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    margin-top: 30px;
">
    <h2 style="color:#1f4e6e; margin-bottom:15px;">SIM Kart Durum Dağılımı</h2>
    <canvas id="statusChart" style="width:100%; height:300px;"></canvas>
</div>
<!-- ORDER STATUS CHART -->
<div style="
    background:white;
    padding:20px;
    border-radius:16px;
    border:1px solid #e5e7eb;
    box-shadow:0 4px 8px rgba(0,0,0,0.05);
    margin-top:30px;
    width:400px;
">
    <div style="
    background:white;
    padding:20px;
    border-radius:16px;
    border:1px solid #e5e7eb;
    box-shadow:0 4px 8px rgba(0,0,0,0.05);
    ">
    <h2 style="color:#1f4e6e; margin-bottom:15px;">Sipariş Durum Dağılımı</h2>
    <canvas id="orderChart" style="width:100%; height:300px;"></canvas>
</div>

<script>
document.addEventListener("DOMContentLoaded", function () {
    var ctx2 = document.getElementById('orderChart').getContext('2d');

    var orderChart = new Chart(ctx2, {
        type: 'pie',
        data: {
            labels: ['Beklemede', 'Tamamlandı', 'İptal Edildi'],
            datasets: [{
                data: [
                    {{ pending_orders }},
                    {{ completed_orders }},
                    {{ canceled_orders }}
                ],
                backgroundColor: [
                    'rgba(250,204,21,0.7)',   // sarı
                    'rgba(34,197,94,0.7)',    // yeşil
                    'rgba(239,68,68,0.7)'     // kırmızı
                ],
                borderColor: [
                    'rgba(250,204,21,1)',
                    'rgba(34,197,94,1)',
                    'rgba(239,68,68,1)'
                ],
                borderWidth: 2
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: {
                    labels: {
                        color: "#1f4e6e",
                        font: { size: 14 }
                    }
                }
            }
        }
    });
});
</script>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
document.addEventListener("DOMContentLoaded", function () {
    var ctx = document.getElementById('statusChart').getContext('2d');

    var statusChart = new Chart(ctx, {
        type: 'pie',
        data: {
            labels: ['Aktif', 'Pasif', 'Blokeli'],
            datasets: [{
                data: [
                    {{ active_count }},
                    {{ passive_count }},
                    {{ blocked_count }}
                ],
                backgroundColor: [
                    'rgba(34,197,94,0.7)',    
                    'rgba(59,130,246,0.7)',   
                    'rgba(239,68,68,0.7)'     
                ],
                borderColor: [
                    'rgba(34,197,94,1)',
                    'rgba(59,130,246,1)',
                    'rgba(239,68,68,1)'
                ],
                borderWidth: 2
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: {
                    labels: {
                        color: "#1f4e6e",
                        font: { size: 14 }
                    }
                }
            }
        }
    });
});
</script>

{% endblock %}
